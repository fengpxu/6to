(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{6347:function(t,e,s){},"6cde":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"take-down"},[s("div",{staticClass:"text-h6"},[t._v("\n    "+t._s(t.$t("takedown_management"))+"\n    "),s("q-icon",{attrs:{name:"help"}},[s("q-tooltip",t._l(t.$t("about_takedown_mode").split("\n"),(function(e){return s("div",{key:e,staticStyle:{"font-size":"14px"}},[t._v(t._s(e))])})),0)],1)],1),s("div",{staticClass:"take-down-lists"},t._l(t.takedownList,(function(e){var a=e.type,o=e.label,n=e.list,i=e.model;return s("q-table",{key:a,staticStyle:{"max-height":"400px"},attrs:{flat:"",dense:"",title:o,data:n,columns:t.columns,"row-key":"name","virtual-scroll":"","rows-per-page-options":[0]},scopedSlots:t._u([{key:"top-row",fn:function(){return[s("q-tr",{staticClass:"takedown-row add"},[s("q-td",{staticClass:"takedown-id"},[s("q-input",{attrs:{placeholder:t.$t(a)+" ID",dense:""},model:{value:i.id,callback:function(e){t.$set(i,"id",e)},expression:"model.id"}})],1),s("q-td",{staticClass:"takedown-reason"},[s("q-select",{attrs:{options:t.reasonOptions,label:t.$t("takedown_reason"),dense:""},model:{value:i.reason,callback:function(e){t.$set(i,"reason",e)},expression:"model.reason"}})],1),s("q-td",[t._v(t._s(t.$t(t.mode)))]),s("q-td",{staticClass:"takedown-admin"},[t._v("("+t._s(t.$t("you"))+")")]),s("q-td",{staticClass:"text-center"},[s("q-btn",{attrs:{flat:"",dense:"",color:"primary",icon:"add"},on:{click:function(e){return t.addTakedown(a)}}})],1)],1)]},proxy:!0},{key:"body",fn:function(e){var o=e.row;return[s("q-tr",{key:o.id,staticClass:"takedown-row"},[s("q-td",{key:"id",staticClass:"takedown-id",attrs:{title:o.id}},[s("q-btn",{staticClass:"q-mr-sm",attrs:{flat:"",dense:"",color:"general",icon:"content_copy",size:"xs"},on:{click:function(e){return t.copy(o.id)}}},[s("q-tooltip",[t._v(t._s(t.$t("copy"))+" ID")])],1),s("span",[t._v(t._s(o.id))])],1),s("q-td",{key:"reason",staticClass:"takedown-reason"},[t._v(t._s(o.reasonLabel))]),s("q-td",{key:"by",staticClass:"takedown-by"},[t._v(t._s(t.$t(o.by)))]),s("q-td",{key:"admins",staticClass:"takedown-admins"},[o.admins?s("div",[s("span",{staticClass:"voted-count",class:{"text-primary":o.selfVoted}},[s("span",[t._v(t._s(o.admins.length)+" voted")]),o.selfVoted?s("q-tooltip",[t._v("You have voted")]):t._e()],1),"committee"===o.by?s("span",{staticClass:"total-count",class:{"text-primary":o.admins.length>=o.minCount}},[t._v("\n                / "+t._s(o.minCount)+" needs to takedown\n              ")]):t._e()]):s("div",[t._v("-")])]),s("q-td",{key:"operations",staticClass:"takedown-operations text-center"},[s("q-btn",{attrs:{flat:"",dense:"",size:"xs",color:o.selfVoted?"negative":"positive",icon:o.selfVoted?"close":"add"},on:{click:function(e){return t.changeVote(a,o)}}}),"preset"===o.by?s("q-tooltip",[t._v(t._s(t.$t("cannot_edit_preset")))]):o.selfVoted?s("q-tooltip",[t._v(t._s(t.$t("remove_vote")))]):s("q-tooltip",[t._v(t._s(t.$t("add_vote")))])],1)],1)]}}],null,!0)})})),1)])},o=[],n=(s("5319"),s("4aad")),i=s("1f5d"),l=s.n(i),d=s("cdde");const r=["Serious Violation","Copyright Disputes","Adults Only"];var c={name:"TakeDown",data(){return{mode:l.a.mode,columns:[{name:"id",label:"ID",field:"id",align:"left",sortable:!0},{name:"reason",label:this.$t("takedown_reason"),field:"reason",align:"left",sortable:!0},{name:"by",label:this.$t("takedown_mode"),field:"by",align:"left",sortable:!0},{name:"admins",label:this.$t("admins"),field:"admins",align:"left",sortable:!1},{name:"operations",label:this.$t("operations"),field:"operations",align:"center",sortable:!1}],reasonOptions:[{label:this.$t("serious_violation"),value:"Serious Violation"},{label:this.$t("copyright_disputes"),value:"Copyright Disputes"},{label:this.$t("adults_only"),value:"Adults Only"}],user:{id:"",reason:{label:this.$t("serious_violation"),value:"Serious Violation"}},channel:{id:"",reason:{label:this.$t("serious_violation"),value:"Serious Violation"}},post:{id:"",reason:{label:this.$t("serious_violation"),value:"Serious Violation"}},lib:n["a"]}},computed:{uid(){return n["a"].user&&n["a"].user.is?n["a"].user.is.pub:""},takedownUsers(){const t=n["a"].takedownList.users,e=n["a"].takedownExtraList.users,s=[];return t.forEach((({id:t,reason:e})=>{s.push({id:t,reason:e,reasonLabel:this.$t(e.replace(/\s/g,"_").toLowerCase()),by:"preset",disable:!0})})),e.forEach((({id:t,reason:e,admins:a,minCount:o})=>{s.push({id:t,reason:e,reasonLabel:this.$t(e.replace(/\s/g,"_").toLowerCase()),admins:a,minCount:o,selfVoted:a.includes(this.uid),by:l.a.mode,disable:!a.includes(this.uid)})})),s},takedownChannels(){const t=n["a"].takedownList.channels,e=n["a"].takedownExtraList.channels,s=[];return t.forEach((({id:t,reason:e})=>{s.push({id:t,reason:e,reasonLabel:this.$t(e.replace(/\s/g,"_").toLowerCase()),by:"preset",disable:!0})})),e.forEach((({id:t,reason:e,admins:a,minCount:o})=>{s.push({id:t,reason:e,reasonLabel:this.$t(e.replace(/\s/g,"_").toLowerCase()),admins:a,minCount:o,selfVoted:a.includes(this.uid),by:l.a.mode,disable:!a.includes(this.uid)})})),s},takedownPosts(){const t=n["a"].takedownList.posts,e=n["a"].takedownExtraList.posts,s=[];return t.forEach((({id:t,reason:e})=>{s.push({id:t,reason:e,reasonLabel:this.$t(e.replace(/\s/g,"_").toLowerCase()),by:"preset",disable:!0})})),e.forEach((({id:t,reason:e,admins:a,minCount:o})=>{s.push({id:t,reason:e,reasonLabel:this.$t(e.replace(/\s/g,"_").toLowerCase()),admins:a,minCount:o,selfVoted:a.includes(this.uid),by:l.a.mode,disable:!a.includes(this.uid)})})),s},takedownList(){return[{type:"user",label:this.$t("users"),model:this.user,list:this.takedownUsers},{type:"channel",label:this.$t("channels"),model:this.channel,list:this.takedownChannels},{type:"post",label:this.$t("posts"),model:this.post,list:this.takedownPosts}]}},methods:{takedownUser(){return 87!==this.user.id.length||this.user.id.split(".").some((t=>43!==t.length))?this.$q.notify(this.$t("takedown_invalid_user_id")):r.includes(this.user.reason.value)?(console.log("takedown user",this.user.id,this.user.reason.value),void n["a"].takedown("user",this.user.id,this.user.reason.value).then(console.log)):this.$q.notify(this.$t("takedown_invalid_reason"))},takedownChannel(){const t=this.channel.id;return 20!==t.length?this.$q.notify(this.$t("takedown_invalid_channel_id")):r.includes(this.channel.reason.value)?void n["a"].takedown("channel",t,this.channel.reason.value):this.$q.notify(this.$t("takedown_invalid_reason"))},takedownPost(){const t=this.post.id;return 20!==t.length?this.$q.notify(this.$t("takedown_invalid_post_id")):r.includes(this.post.reason.value)?void n["a"].takedown("post",t,this.post.reason.value):this.$q.notify(this.$t("takedown_invalid_reason"))},untakedownUser(t){n["a"].takedown("user",t,"None")},addTakedown(t){return console.log("add",t),"user"===t?this.takedownUser():"channel"===t?this.takedownChannel():"post"===t?this.takedownPost():void 0},removeTakedown(t,e){return console.log("untakedown",t,e),"user"===t?this.untakedownUser(e):"channel"===t?n["a"].takedown("channel",e,"None"):"post"===t?n["a"].takedown("post",e,"None"):void 0},changeVote(t,e){return"preset"===e.by?console.log(e):e.selfVoted?this.removeTakedown(t,e.id):void n["a"].takedown(t,e.id,e.reason).then(console.log)},copy(t){Object(d["a"])(t).then((()=>{this.$q.notify(this.$t("copied"))}))}},activated(){this.$root.$emit("navigate-to"),this.$root.$emit("navigate-to","/library/takedown"),this.lib.setSearchOption([])}},u=c,h=(s("bdec"),s("2877")),p=s("0016"),k=s("05c0"),w=s("eaac"),_=s("bd08"),b=s("db86"),v=s("27f9"),m=s("ddd8"),f=s("9c40"),y=s("b498"),$=s("eebe"),C=s.n($),g=Object(h["a"])(u,a,o,!1,null,"abe53340",null);e["default"]=g.exports;C()(g,"components",{QIcon:p["a"],QTooltip:k["a"],QTable:w["a"],QTr:_["a"],QTd:b["a"],QInput:v["a"],QSelect:m["a"],QBtn:f["a"],QColor:y["a"]})},bdec:function(t,e,s){"use strict";s("6347")}}]);