(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[15],{"4e99":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"scrollEl",staticClass:"local-favorite",class:{web:!e.isElectron}},[a("input",{ref:"fileSelector",staticStyle:{display:"none"},attrs:{type:"file",name:"input-file",accept:".json"},on:{change:e.onFileChange}}),a("div",{staticClass:"library-inner-container"},[a("VirtualScrollGrid",{staticClass:"library-grid",attrs:{virtualScrollSliceRow:0,itemWidth:560,itemHeight:473,gutter:8,itemsSize:e.filteredFavorites.length,itemsFn:function(t,a){return e.filteredFavorites.slice(t,a)}},on:{"virtual-scroll":function(t){var a=t.from;return e.scrollIndex=a||0}},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.item;return[a("PostCard",{key:o.id,attrs:{post:o,followable:!e.lib.followingChannels.some((function(e){return e.id===o.channel.id}))},on:{follow:e.onFollow,preview:e.preview,"to-channel":e.toChannelPage}})]}},{key:"after",fn:function(){return[a("div",{staticClass:"rounded-borders bg-page column justify-center items-center",class:e.filteredFavorites.length?"q-mb-sm q-pa-md":"",style:e.filteredFavorites.length?{}:{height:"calc(100vh - var(--header-height) - var(--appbar-height) - 8px)"}},[e.filteredFavorites.length?e._e():a("div",[a("q-icon",{attrs:{name:"error_outline",size:"1.2rem"}}),a("span",{staticClass:"q-ml-sm"},[e._v(e._s(e.$t("credit_no_data")))])],1)])]},proxy:!0}])}),e._e()],1),e._e(),a("BackToTop",{attrs:{show:e.scrollIndex>0||e.showBackToTop},on:{click:e.handleBackToTop}}),a("div",{staticClass:"fixed-bottom-right save-or-load",class:{higher:e.scrollIndex>0||e.showBackToTop}},[a("q-btn",{staticClass:"backup-btn q-ma-xs",class:{hide:e.hideBtn},attrs:{fab:"","no-wrap":"",size:"18px",color:"primary",icon:"source"},on:{click:e.saveOrLoad}},[a("div",{staticClass:"fab-inner-text"},[e._v(e._s(e.$t("backup")))])])],1),a("q-dialog",{model:{value:e.showPreview,callback:function(t){e.showPreview=t},expression:"showPreview"}},[a("q-card",{staticClass:"image-preview-card"},[a("q-card-section",{staticClass:"q-pa-none"},[a("img",{staticClass:"preview-image",attrs:{src:e.previewImage}})]),a("q-card-actions",{staticClass:"q-pa-none",staticStyle:{position:"absolute",bottom:"0",right:"0"},attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",padding:"none",size:"20px",icon:"close",color:"grey"}})],1)],1)],1),a("q-dialog",{model:{value:e.showDialog,callback:function(t){e.showDialog=t},expression:"showDialog"}},[a("q-card",[a("q-card-section",{staticClass:"row"},[a("div",{staticClass:"text-h6 col-12"},[e._v(e._s(e.$t("import_or_export_favorites")))]),a("div",{staticClass:"col-12"},[e._v("\n            Total: "+e._s(e.favorites.length)+"\n          ")]),a("div",{staticClass:"btns col-12 text-right q-mt-md"},[a("q-btn",{attrs:{color:"primary",flat:"",icon:"save",label:e.$t("export_local_favorites")},on:{click:e.exportData}}),a("q-btn",{staticClass:"q-ml-md",attrs:{color:"primary",flat:"",icon:"add",label:e.$t("import_favorites_file")},on:{click:e.importData}})],1)])],1)],1)],1)},i=[],s=(a("e01a"),a("e9c4"),a("71ac")),r=a("2de9"),l=a("0ebe"),n=a("4aad"),c=a("bae3"),d=a("ed08"),h=a("e64e"),v=a("decc"),f=a("3013"),p={name:"LibraryFavorite",components:{PostCard:r["a"],BackToTop:l["a"]},mixins:[h["a"],Object(v["a"])("favorite"),f["a"]],data(){return{isElectron:Object(d["isElectron"])(),hideBtn:!1,favorites:s["a"].list(),scrollIndex:0,showPreview:!1,previewImage:"",showDialog:!1,lib:n["a"]}},computed:{filteredFavorites(){const e=this.searchText.toLowerCase(),t=n["a"].search.option.value,a=e=>{var a;switch(t){case"channel":return null===(a=e.channel)||void 0===a?void 0:a.title;case"postID":return e.id;case"postDesc":return e.description;default:return e.title}},o=t=>{var o;return null===(o=a(t))||void 0===o?void 0:o.toLowerCase().includes(e)};return this.favorites.filter(o)}},methods:{onScroll(e){this.scrollIndex=e.index},preview(e){this.previewImage=e,this.showPreview=!0},remove(e){return s["a"].remove(e)},saveOrLoad(){this.showDialog=!0},exportData(){Object(c["g"])(JSON.stringify({favorites:this.favorites}),"favorites.json"),this.showDialog=!1},importData(){console.log(this.$refs.fileSelector),this.$refs.fileSelector.value="",this.$refs.fileSelector.click()},onFileChange(e){var t,a;null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&null!==(a=t.files)&&void 0!==a&&a[0]&&Object(c["f"])(e.target.files[0]).then((e=>{if(!e)return this.$q.notify("Cannot read data from this file");const t=JSON.parse(e);if(!t.favorites||!Array.isArray(t.favorites))return this.$q.notify(this.$t("not_a_favorite_file"));s["a"].set(t.favorites),this.showDialog=!1}))},onFollow(e){if(n["a"].followingChannels.some((t=>t.id===e||t.soul===e)))return console.log("unfollow"),n["a"].unfollowChannel(e).then(console.log);console.log("follow"),n["a"].followChannel(e).then(console.log)},toChannelPage(e){console.log("to",e);const t=["id","title"].map((t=>{const a=e[t];return encodeURIComponent(t)+"="+encodeURIComponent(a)})).join("&"),a=`/library/channel?${t}`;this.$root.$emit("navigate-to",a),this.$router.push(a)},setSearch(){this.lib.setSearchOption([{label:this.$t("post_title"),value:"postTitle"},{label:this.$t("description"),value:"postDesc"},{label:this.$t("channel_title"),value:"channel"}])}},activated(){this.setSearch(),this.$root.$emit("navigate-to"),this.$root.$emit("navigate-to","/library/favorite"),this.hideBtn=!0,setTimeout((()=>{this.hideBtn=!1}),300)},deactivated(){this.hideBtn=!0}},u=p,g=(a("fa7c"),a("2877")),m=a("0016"),b=a("eaac"),w=a("6b1d"),C=a("d9b2"),_=a("eb85"),x=a("3b16"),y=a("a12b"),$=a("9c40"),q=a("24e8"),S=a("f09f"),k=a("a370"),D=a("4b7e"),T=a("7f67"),I=a("eebe"),F=a.n(I),P=Object(g["a"])(u,o,i,!1,null,"230158d7",null);t["default"]=P.exports;F()(P,"components",{QIcon:m["a"],QTable:b["a"],QLinearProgress:w["a"],QSpinnerIos:C["a"],QSeparator:_["a"],QPagination:x["a"],QVirtualScroll:y["a"],QBtn:$["a"],QDialog:q["a"],QCard:S["a"],QCardSection:k["a"],QCardActions:D["a"]}),F()(P,"directives",{ClosePopup:T["a"]})},"55be":function(e,t,a){},fa7c:function(e,t,a){"use strict";a("55be")}}]);