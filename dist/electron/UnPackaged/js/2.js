(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{9224:function(e){e.exports=JSON.parse('{"name":"alphabiz-app","main":"src-electron/main-process/electron-main.js","version":"0.2.3","description":"Alphabiz Blockchain Cryptocurrency Application","productName":"Alphabiz","author":"Alphabiz Team <dev@alpha.biz>","private":true,"scripts":{"predev":"node update-version.js --dev && node ./node_modules/symlink-dir/dist/cli.js ./developer ./public/developer","preweb":"node update-version.js --dev --web","prebuild":"node update-version.js && node ./node_modules/symlink-dir/dist/cli.js ./developer ./public/developer","prebuild-spa":"node update-version.js --web && node ./node_modules/symlink-dir/dist/cli.js ./developer ./public/developer","prebuild-src":"node update-version.js","pretest:e2e":"node update-version.js","pretest:e2e:ci":"node update-version.js --dev","pretest-s:e2e:ci":"node update-version.js","pretest:e2e:electron":"node update-version.js && node ./node_modules/symlink-dir/dist/cli.js ./developer ./public/developer","pretest:e2e:electron:ci":"node update-version.js --dev","pretest-s:e2e:electron:ci":"node update-version.js && node test-secret/playwright/get-email.js","pretest:e2e:electron:library":"node update-version.js","pretest:e2e:electron:download":"node update-version.js","pretest:playwright":"node update-version.js && node test-secret/playwright/get-email.js","make-patch":"npx patch-package @quasar/app","dev":"quasar dev -m electron","dev-mobile":"node src-capacitor/index.js --dev","capacitor":"quasar dev -m capacitor -T android","capacitor-ios":"quasar dev -m capacitor -T ios","web":"quasar d","build":"quasar build -m electron","build-spa":"quasar build","build-src":"quasar build -m electron --src","build-android":"node src-capacitor/index.js --build --android && quasar build -m capacitor -T android --ide","build-ios":"node src-capacitor/index.js --build --ios && (quasar build -m capacitor -T ios || true)","postbuild-ios":"node src-capacitor/index.js --reset","postbuild":"node src-electron/post-build","postbuild-src":"node src-electron/post-build-src","lint":"eslint --ext .js,.vue ./","postinstall":"patch-package && yarn --cwd src-capacitor && node ./node_modules/symlink-dir/dist/cli.js node_modules/@zeeis/velectron node_modules/electron && ./node_modules/.bin/electron-rebuild -v 17.0.0","test:unit":"jest --updateSnapshot --c=jest.config.js","test:unit:ci":"jest --ci","test:unit:coverage":"jest --coverage","test:unit:watch":"jest --watch","test:unit:watchAll":"jest --watchAll","serve:test:coverage":"quasar serve test/jest/coverage/lcov-report/ --port 8788","concurrently:dev:jest":"concurrently \\"quasar dev\\" \\"jest --watch\\"","test:e2e":"cross-env E2E_TEST=true START_SERVER_AND_TEST_INSECURE=1 start-test \\"quasar dev\\" https://localhost:8080 \\"cypress open --config-file test/cypress/cypress-config.json \\"","test-s:e2e":"cross-env E2E_TEST=true START_SERVER_AND_TEST_INSECURE=1 start-test \\"quasar dev\\" https://localhost:8080 \\"cypress open --config-file test-secret/cypress/cypress-config.json \\"","test:e2e:ci":"cross-env E2E_TEST=true START_SERVER_AND_TEST_INSECURE=1 start-test \\"quasar dev\\" https://localhost:8080 \\"cypress run --config-file test/cypress/cypress-config.json --spec \\"test/cypress/integration/main/**\\" --browser chrome\\"","test:e2e:website:ci":"cross-env E2E_TEST=true cypress run --config baseUrl=https://web.alpha.biz --config-file test/cypress/cypress-config.json --spec \\"test/cypress/integration/website/**\\" --browser chrome","test-s:e2e:ci":"cross-env E2E_TEST=true START_SERVER_AND_TEST_INSECURE=1 start-test \\"quasar dev\\" https://localhost:8080 \\"cypress run --config-file test-secret/cypress/cypress-config.json --spec \\"test-secret/cypress/integration/account/account.spec.js\\" --browser chrome\\"","test-s:e2e:ci-parallel":"cross-env E2E_TEST=true START_SERVER_AND_TEST_INSECURE=1 start-test \\"quasar dev\\" https://localhost:8080 \\"cypress run --config-file test-secret/cypress/cypress-config.json --spec \\"test-secret/cypress/integration/account/account-email.spec.js\\" --browser chrome\\"","test-s:e2e:website:ci":"cross-env E2E_TEST=true cypress run --config baseUrl=https://web.alpha.biz --config-file test-secret/cypress/cypress-config.json --spec \\"test-secret/cypress/integration/website/account-email.spec.js\\" --browser chrome","test:e2e:electron":"quasar d -m electron --e2e","test:e2e:electron:ci":"cross-env E2E_TEST=true start-test \\"quasar d -m electron --e2e\\" 8080 \\"xvfb-maybe -- playwright test main wallet library\\"","test:e2e:electron:library":"cross-env E2E_TEST=true start-test \\"quasar d -m electron --e2e\\" 8080 \\"xvfb-maybe -- playwright test test/playwright/library.spec.js\\"","test-s:e2e:electron:ci":"cross-env E2E_TEST=true start-test \\"quasar d -m electron --e2e\\" 8080 \\"xvfb-maybe -- playwright test test-secret/playwright/account.spec.js\\"","test:e2e:electron:download":"cross-env E2E_TEST=true start-test \\"quasar d -m electron --e2e\\" 8080 \\"xvfb-maybe -- playwright test test/playwright/download.spec.js\\"","test:appium":"appium --log ./test/output/release/appium.log","test:release":"jest test/jest/release/main.spec.js --c=./test/jest/release/jest.config.js","test:release:download":"jest test/jest/release/download.spec.js --c=./test/jest/release/jest.config.js","test:release:creditsUpload":"jest test/jest/release/creditsUpload.spec.js --c=./test/jest/release/jest.config.js","test:release:creditsDownload":"jest test/jest/release/creditsDownload.spec.js --c=./test/jest/release/jest.config.js","make":"node build-scripts/common/make.js --make","make:win":"yarn make:squirrel && yarn make:msi && yarn make:appx","make:squirrel":"yarn pkg-fmt -f exe && electron-forge make --skip-package --targets @electron-forge/maker-squirrel","make:appx":"yarn pkg-fmt -f appx && electron-forge make --skip-package --targets @electron-forge/maker-appx","make:msi":"yarn pkg-fmt -f msi && node ./build-scripts/windows/wix/make.js","make:dmg":"yarn pkg-fmt -f dmg && electron-forge make --skip-package --targets @electron-forge/maker-dmg","make:deb":"yarn pkg-fmt -f deb && electron-forge make --skip-package --targets @electron-forge/maker-deb","make:snap":"yarn pkg-fmt -f snap && node build-scripts/linux/snapcraft && snapcraft snap --output=./out/installers/app.snap && node build-scripts/linux/snapcraft --post","postmake":"node build-scripts/common/make.js --postmake","pkg-fmt":"node build-scripts/common/getPackageFormat.js"},"dependencies":{"@electron/remote":"2.x","@quasar/extras":"1.12.5","@zeeis/alphabiz-account":"^0.0.89","@zeeis/alphabiz-libdb":"^0.0.91","axios":"^0.21.1","big-json":"^3.2.0","bip39":"^3.0.4","bittorrent-dht":"^10.0.0","bittorrent-tracker":"^9.17.3","bytebuffer":"^5.0.1","bytes":"^3.1.2","chardet":"^1.5.0","color":"^4.2.3","core-js":"^3.6.5","countries-list":"^2.6.1","crypto-js":"^3.1.9-1","csv":"^6.2.0","diskusage":"^1.1.3","electron-context-menu":"^3.1.1","electron-default-menu":"^1.0.2","electron-is":"^3.0.0","electron-squirrel-startup":"^1.0.0","electron-store":"^8.0.0","entities":"^3.0.1","es-event-emitter":"^1.3.9","filestream":"^5.0.0","font-awesome":"^4.7.0","fswin":"^3.23.119","geoip-country":"^4.1.4","gun":"^0.2020.1237","iconv-lite":"^0.6.3","jszip":"^3.10.1","libjass":"^0.11.0","lzma-native":"^8.0.1","lzma-web":"^3.0.1","magnet-uri":"^6.2.0","markdown-it":"^12.3.2","name-styles":"^2.2.0","nan":"^2.14.2","nanoid":"^3.1.31","node-schedule":"^2.1.0","parse-torrent":"^9.1.3","ping":"^0.4.1","qrcode":"^1.4.4","quasar":"^1.0.0","semver":"^7.3.7","smtp-tester":"^1.2.0","symlink-dir":"^5.0.1","twitter-text":"^3.1.0","video.js":"^7.13.3","videojs-ass":"^0.8.0","videojs-ass-es6":"0.0.4","videojs-hotkeys":"^0.2.27","vue-class-component":"^7.2.6","vue-i18n":"^8.24.5","vue-property-decorator":"^9.1.2","vue-recaptcha-v3":"1.9.0","webtorrent":"1.5.8","winreg":"^1.2.4","ws":"^8.8.0","xlsx":"^0.18.5"},"devDependencies":{"@electron-forge/cli":"^6.0.0-beta.63","@electron-forge/maker-appx":"^6.0.0-beta.63","@electron-forge/maker-deb":"^6.0.0-beta.63","@electron-forge/maker-dmg":"^6.0.0-beta.63","@electron-forge/maker-rpm":"^6.0.0-beta.63","@electron-forge/maker-snap":"^6.0.4","@electron-forge/maker-squirrel":"^6.0.0-beta.63","@electron-forge/maker-wix":"^6.0.0-beta.63","@electron-forge/maker-zip":"^6.0.0-beta.63","@electron-forge/plugin-local-electron":"6.0.0-beta.63","@playwright/test":"^1.16.3","@quasar/app":"^2.0.0","@quasar/quasar-app-extension-testing":"^1.0.3","@quasar/quasar-app-extension-testing-e2e-cypress":"^3.1.0","@quasar/quasar-app-extension-testing-unit-jest":"^2.2.2","@types/geoip-country":"^4.0.0","@types/lodash":"^4.14.179","@types/node":"16","@types/plist":"^3.0.2","@types/semver":"^7.3.9","@types/twitter-text":"^3.1.1","@typescript-eslint/eslint-plugin":"^5.13.0","@typescript-eslint/parser":"^5.13.0","@zeeis/velectron":"^17.0.0","appium":"^1.22.1","aws-amplify":"^4.2.2","aws-amplify-vue":"^2.1.5","aws-sdk":"^2.1037.0","babel-eslint":"^10.0.1","chai":"^4.3.4","commander":"^10.0.0","csv-parse":"^5.0.4","cypress":"^8.6.0","cypress-file-upload":"^5.0.8","devtron":"^1.4.0","dotenv":"^10.0.0","electron":"17.0.0","electron-debug":"^3.0.1","electron-devtools-installer":"^3.0.0","electron-installer-snap":"^5.1.0","electron-installer-zip":"^0.1.2","electron-packager":"^14.1.1","electron-rebuild":"^3.2.6","electron-wix-msi":"^4.0.0","eslint":"^6.8.0","eslint-config-standard":"^14.1.0","eslint-loader":"^3.0.3","eslint-plugin-cypress":"^2.11.1","eslint-plugin-import":"^2.14.0","eslint-plugin-jest":"^24.1.0","eslint-plugin-node":"^11.0.0","eslint-plugin-promise":"^4.0.1","eslint-plugin-standard":"^4.0.0","eslint-plugin-vue":"^6.1.2","glob-parent":"^5.1.2","http-server":"^14.1.0","imap":"^0.8.19","jest-circus":"^27.4.2","jest-jasmine2":"^27.4.2","json":"^11.0.0","mail-listener2":"^0.3.1","mailparser":"^3.4.0","mocha":"^9.1.2","patch-package":"^6.4.7","playwright":"^1.16.3","plist":"^3.0.5","raw-loader":"^4.0.2","selenium-appium":"^1.0.2","selenium-webdriver":"^4.1.0","start-server-and-test":"^1.14.0","twilio":"^3.71.1","webdriverio":"^7.16.11","xvfb-maybe":"^0.2.1"},"optionalDependencies":{"electron-installer-debian":"^3.1.0","exe-icon-extractor":"^1.0.8","fswin":"^3.23.119"},"resolutions":{"bittorrent-protocol":"3.5.1","bufferutil":"4.0.6","create-torrent":"5.0.1","electron-wix-msi":"^4.0.0","fs-chunk-store":"2.0.4","utf-8-validate":"5.0.8"},"browserslist":["last 10 Chrome versions","last 10 Firefox versions","last 4 Edge versions","last 7 Safari versions","last 8 Android versions","last 8 ChromeAndroid versions","last 8 FirefoxAndroid versions","last 10 iOS versions","last 5 Opera versions"],"engines":{"node":">= 10.18.1","npm":">= 6.13.4","yarn":">= 1.21.1"},"config":{"forge":"./build-scripts/common/forge.config.js"}}')},bb44:function(e,t,s){"use strict";s.r(t),s.d(t,"ipcRenderer",(function(){return Be}));s("ddb0"),s("5319"),s("498a");var o=s("3c93"),n=s("ff4a"),r=s.n(n),a=s("9b0f"),i=s("a32b"),l=s("ad2b"),c=s.n(l),d=s("50b2"),p=s("c29d"),u=s("df4f"),m=s.n(u),g=s("9224"),f=s("6462"),h=s("5110"),y=(s("d9e2"),s("8e57")),b=s.n(y);let v=process.argv.includes("--home-dir")?Object(i["dirname"])(process.argv[process.argv.indexOf("--home-dir")]):process.argv[2]&&!process.argv[2].startsWith("-")?process.argv[2]:"ios"===b.a.platform()?b.a.homedir():Object(i["resolve"])(b.a.homedir(),g.name);if(!v)for(let Ye=2;Ye<process.argv.length;Ye++){const e=process.argv[Ye];if(Object(a["existsSync"])(e)){v=e;break}v=""}if(!v){const e=`Cannot parse homedir from args ${process.argv.join(" ")}`;throw new Error(e)}if(console.log("homedir:",v),v.endsWith("node")&&(v=Object(i["resolve"])(v,"..",g.name)),!Object(a["existsSync"])(v))try{Object(a["mkdirSync"])(v,{recursive:!0})}catch(Je){console.warn(`Cannot create homedir ${v}`,Je.message||Je)}var _=v,w=s("2849"),k=(s("9f96"),s("2b3d"),s("9861"),s("74a0")),S=s.n(k),j=s("451f"),T=s.n(j),H=s("a876"),E=s.n(H),x=s("6f59"),A=s.n(x);const C=(e,t)=>`\n    <!DOCTYPE html>\n    <html lang="en">\n      <head>\n        <meta charset="utf-8">\n        <title>${e}</title>\n      </head>\n      <body>\n        ${t}\n      </body>\n    </html>\n  `,O=e=>encodeURIComponent(e).replace(/['()]/g,escape).replace(/\*/g,"%2A").replace(/%(?:7C|60|5E)/g,unescape);function N(e,t={}){const s=Object(w["createServer"])();t.origin||(t.origin="*");const o=new Set,n=new Set;let r=!1;const a=s.listen,i=s.close;s.listen=(...e)=>(r=!1,s.on("connection",c),s.on("request",d),a.apply(s,e)),s.close=t=>{r=!0,s.removeListener("connection",c),s.removeListener("request",d),n.forEach((t=>{e.removeListener("ready",t)})),n.clear(),i.call(s,t)},s.destroy=t=>{t||(t=()=>{}),o.forEach((e=>{e.destroy()})),r?queueMicrotask(t):s.close(t),e=null};const l=e=>!1!==t.origin&&(null!==e.headers.origin&&("*"===t.origin||e.headers.origin===t.origin)),c=e=>{e.setTimeout(36e6),o.add(e),e.once("close",(()=>{o.delete(e)}))},d=(o,r)=>{if(t.hostname&&o.headers.host!==`${t.hostname}:${s.address().port}`)return o.destroy();const a=o.url,i=new URL(a,"http://example.com").pathname;l(o)&&r.setHeader("Access-Control-Allow-Origin",o.headers.origin),r.setHeader("X-Content-Type-Options","nosniff"),r.setHeader("Content-Security-Policy","base-uri 'none'; default-src 'none'; frame-ancestors 'none'; form-action 'none';");const c=()=>{r.statusCode=200,r.setHeader("Content-Type","text/html");const t=e.files.map(((e,t)=>`\n        <li>\n          <a\n            download="${S()(e.name)}"\n            href="${S()(t)}/${S()(e.name)}"\n          >\n            ${S()(e.path)}\n          </a>\n          (${S()(e.length)} bytes)\n        </li>\n      `)),s=C(`${S()(e.name)} - WebTorrent`,`\n          <h1>${S()(e.name)}</h1>\n          <ol>${t}</ol>\n        `);r.end(s)},d=()=>{r.statusCode=404,r.setHeader("Content-Type","text/html");const e=C("404 - Not Found","<h1>404 - Not Found</h1>");r.end(e)},p=e=>{r.setHeader("Content-Type",E.a.getType(e.name)||"application/octec-stream"),r.setHeader("Accept-Ranges","bytes"),r.setHeader("Content-Disposition",`inline; filename*=UTF-8''${O(e.name)}`),r.setHeader("transferMode.dlna.org","Streaming"),r.setHeader("contentFeatures.dlna.org","DLNA.ORG_OP=01;DLNA.ORG_CI=0;DLNA.ORG_FLAGS=01700000000000000000000000000000");const t=T()(e.length,o.headers.range||"");if(Array.isArray(t)){r.statusCode=206;const s=t[0];if(r.setHeader("Content-Range",`bytes ${s.start}-${s.end}/${e.length}`),r.setHeader("Content-Length",s.end-s.start+1),"HEAD"===o.method)return r.end();A()(e.createReadStream(s),r)}else{if(r.statusCode=200,r.setHeader("Content-Length",e.length),"HEAD"===o.method)return r.end();A()(e.createReadStream(null),r)}},u=()=>{r.statusCode=204,r.setHeader("Access-Control-Max-Age","600"),r.setHeader("Access-Control-Allow-Methods","GET,HEAD"),o.headers["access-control-request-headers"]&&r.setHeader("Access-Control-Allow-Headers",o.headers["access-control-request-headers"]),r.end()},m=()=>{r.statusCode=405,r.setHeader("Content-Type","text/html");const e=C("405 - Method Not Allowed","<h1>405 - Method Not Allowed</h1>");r.end(e)},g=()=>{if("/"===i)return c();const t=Number(i.split("/")[1]);if(isNaN(t)||t>=e.files.length)return d();const s=e.files[t],o=a.split("wait=")[1];s.cacheRate=o,p(s)},f=()=>{n.delete(f),g()};if("/favicon.ico"===i)return d();if("OPTIONS"===o.method)return l(o)?u():m();if("GET"===o.method||"HEAD"===o.method){if(e.ready)return g();n.add(f),e.once("ready",f)}return m()};return s}var U=s("90bd"),q=s("708e"),D=s.n(q);const L=[],R=new Map;function $(e,t){R.has(e)?R.get(e).push(t):R.set(e,[t])}function I(e,...t){L.push({name:e,data:t})}function P(e,...t){for(let s=0;s<L.length;s++)L[s].name===e&&L.splice(s--,1);L.push({name:e,data:t})}function M(e,t){const s=R.get(e);if(s)for(let o=0;o<s.length;o++)s[o]===t&&s.splice(o--,1)}const z={on:$,off:M,emit:I,emitSingle:P};var F=z,G=s("c282"),V=s.n(G);const{version:W,name:B}=g;class J extends V.a{constructor(e){const t=_,s=W;e={name:"config",...e},e.projectVersion||(e.projectVersion=s),e.cwd?e.cwd=Object(i["isAbsolute"])(e.cwd)?e.cwd:Object(i["join"])(t,e.cwd):e.cwd=t,e.configName=e.name,delete e.name,super(e)}}var Y=J,Q={about:"About",services:"Services",hide:"Hide",hide_others:"Hide Others",show_all:"Show All",quit:"Quit",file:"File",open_file:"Open File ...",edit:"Edit",undo:"Undo",redo:"Redo",cut:"Cut",copy:"Copy",paste:"Paste",select_all:"Select All",view:"View",reload:"Reload",toggle_full_screen:"Toggle Full Screen",toggle_developer_tools:"Toogle Developer Tools",window:"Window",minimize:"Minimize",close:"Close",bring_all_to_front:"Bring All to Front",help:"Help",github_repo:"Github Repo",issues:"Issues",learn_more:"Learn More",official_site:"Official Site",check_for_update:"Check For Update",learn_spelling:"Learn Spelling",lookup_selection:"Look Up '{selection}'",search_with_google:"Search with Google",save_as:"Save As",save_image:"Save Image",save_image_as:"Save Image As ...",copy_link:"Copy Link",save_link_as:"Save Link As ...",copy_image:"Copy Image",copy_image_as:"Copy Image As ...",copy_image_address:"Copy Image Address",download_complete:"Download complete",download_complete_message:"{0} is downloaded",is_running:"{0} is running",open:"Open {0}",launch_problem:"Launch problem",ask_clear_data:`It seems you are trying to launch ${D.a.displayName} but failed for several times.\nDo you want to clear all app data and try launch later?`,launch_directly:"Launch directly",clear_all_data:"Clear all data",confirm:"Confirm",ask_clear_confirm:`This will remove all configs, logs and user data!\nAfter this you may need to launch ${D.a.displayName} again.\nAre you sure to clear data?`,confirm_launch:"No, launch directly",confirm_clear:"Yes, clear all data"},X={about:"关于",services:"服务",hide:"隐藏",hide_others:"隐藏其他",show_all:"显示全部",quit:"退出",file:"文件",open_file:"打开文件 ...",edit:"编辑",undo:"撤销",redo:"重做",cut:"剪切",copy:"复制",paste:"粘贴",select_all:"全选",view:"显示",reload:"重载",toggle_full_screen:"切换全屏",toggle_developer_tools:"切换开发者工具",window:"窗口",minimize:"最小化",close:"关闭",bring_all_to_front:"前置全部窗口",help:"帮助",github_repo:"Github 仓库",issues:"Issues",learn_more:"更多",official_site:"官方网站",check_for_update:"检查更新",learn_spelling:"学习拼写",lookup_selection:"查询“{selection}”",search_with_google:"用 Google 搜素",save_as:"保存为",save_image:"保存图片",save_image_as:"将图片另存为 ...",copy_link:"复制链接",save_link_as:"将链接复制为 ...",copy_image:"复制图片",copy_image_as:"将图片复制为 ...",copy_image_address:"复制图片地址",download_complete:"下载完成",download_complete_message:"{0} 已下载完成",is_running:"{0} 正在运行",open:"打开 {0}",launch_problem:"启动异常",ask_clear_data:`您似乎在短时间内多次尝试启动 ${D.a.displayName}。\n如果遇到问题，您可以清除所有数据后重试`,launch_directly:"直接启动",clear_all_data:"清除所有数据",confirm:"二次确认",ask_clear_confirm:`此操作将清除所有用户配置和数据！\n清除数据后需要手动启动 ${D.a.displayName}。\n是否仍要继续？`,confirm_launch:"否，直接启动",confirm_clear:"是，清除所有数据"},K={about:"關於",services:"服務",hide:"隱藏",hide_others:"隱藏其他",show_all:"顯示全部",quit:"退出",file:"文檔",open_file:"打開文檔 ...",edit:"編輯",undo:"撤銷",redo:"重做",cut:"剪切",copy:"複製",paste:"粘貼",select_all:"全選",view:"顯示",reload:"重載",toggle_full_screen:"切換全螢幕",toggle_developer_tools:"切換開發者工具",window:"窗口",minimize:"最小化",close:"關閉",bring_all_to_front:"前置全部窗口",help:"幫助",github_repo:"Github 倉庫",issues:"Issues",learn_more:"更多",official_site:"官方網站",check_for_update:"檢索更新",learn_spelling:"學習拼寫",lookup_selection:"查詢“{selection}”",search_with_google:"用 Google 檢索",save_as:"保存為",save_image:"保存圖片",save_image_as:"將圖片另存為 ...",copy_link:"複製連結",save_link_as:"將連結複製為 ...",copy_image:"複製圖片",copy_image_as:"將圖片複製為 ...",copy_image_address:"複製圖片地址",download_complete:"下載完成",download_complete_message:"{0} 已下載完成",is_running:"{0} 正在運行",open:"打開 {0}",launch_problem:"啟動異常",ask_clear_data:`您似乎在短時間內多次嘗試啟動 ${D.a.displayName}。\n如果遇到問題，您可以清除所有數據後重試`,launch_directly:"直接啟動",clear_all_data:"清除所有數據",confirm:"二次確認",ask_clear_confirm:`此操作將清除所有用戶配置和數據！\n清除數據後需要手動啟動 ${D.a.displayName}。\n是否仍要繼續？`,confirm_launch:"否，直接啟動",confirm_clear:"是，清除所有數據"};const Z={"en-US":Q,"zh-CN":X,"zh-TW":K};class ee{constructor(e="en-US"){this.locale=e in Z?e:"en-US",this._messages={},this.setLocale(e)}setLocale(e){e in Z?(this.locale=e,this._messages={...Z[e]}):(console.warn(`[i18n] Cannot load locale ${e}. Ensure you have added this locale.`),this.locale="en-US",this._messages={...Z[e]})}rawText(e){return this._messages[e]?this._messages[e]:(console.warn(`[i18n] Warning: ${e} is not added in current locale ${this.locale}`),Z["en-US"][e]?Z["en-US"][e]:(console.warn(`[i18n] Warning: Failed to fallback to en-US for ${e}`),e))}$t(e,t={}){return this.rawText(e).replace(/{(.+)?}/g,((e,s)=>t[s]?t[s]:`{${s}}`))}}const{version:te,name:se}=g,oe=Object(i["resolve"])(_,"downloads"),ne=Object(i["resolve"])(_,`${D.a.name.toLowerCase()}-config.json`),re=new ee("en-US");class ae{constructor(){this.userSettings={},this.init()}init(){if(this.initUserSettings(),this.userSettings.get("autoUpdateTrackerServiceList")){const e=new Date(this.userSettings.get("trackerLastUpdateTime"));e.setDate(e.getDate()+1);Date.now();e.valueOf()}process.env.DISABLE_FORCE_LOGIN||process.argv.includes("--disable-force-login")?(console.log("Disabled force login"),this.userSettings.set("forceLogin",!1)):this.userSettings.set("forceLogin",!0)}initUserSettings(){this.checkInit(),console.log("New store @",ne),this.userSettings=new Y({name:`${D.a.name.toLowerCase()}-config`,defaults:Object.assign(U["a"],{locale:"en-US",downloadDirectory:oe,uploadDirectory:Object(i["resolve"])(oe,"auto-upload"),versionChannel:"stable"}),projectVersion:te}),this.localeDeps=[];const e=this.userSettings.get("language");e&&this.updateLocales(e)}checkInit(){Object(a["existsSync"])(ne)||F.emit("app-init")}set locale(e){re.setLocale(e)}get locale(){return re.locale}$t(e,t){return re.$t(e,t)}updateLocales(e){this.local=e,this.localeDeps.forEach((e=>e()))}onLocaleChange(e){"function"===typeof e&&(e(),this.localeDeps.push(e))}getUserSettings(e,t){return"undefined"===typeof e&&"undefined"===typeof t?this.userSettings.store:this.userSettings.get(e,t)}getLanguage(){return this.getUserSettings(),this.getUserSettings("language")}setUserSettings(e){const t={};Object.keys(e).forEach((s=>{const o=e[s];switch(this.userSettings.set(s,o),s){case"language":return this.updateLocales(o);case"uploadSpeed":case"downloadSpeed":case"maximumDownloadNum":case"maximumConnectionsNum":case"payedUserShareRate":case"DHTlistenPort":case"BTlistenPort":case"secureOption":case"libraryPreload":case"showPreload":t[s]=o;break}})),Object.keys(t).length&&console.log("update torrent setting",t)}resetSettings(){this.userSettings.clear()}get path(){return this.userSettings.path}}const ie=new ae,le=Object(i["resolve"])(_,"download"),ce=new r.a,de=p.version,pe=de.replace(/\d*./g,(e=>("0"+e%100).slice(-2))).slice(0,4),ue=Buffer.from(`-WW${pe}-${Object(o["randomBytes"])(9).toString("base64")}`);class me extends Map{set(e,t){if("object"!==typeof t)return console.error("Not an object",t);super.set(e,Object.assign({url:e},t,{timestamp:Date.now()}))}}const ge=e=>"number"!==typeof e?-1:e>0?parseInt(e):-1,fe=e=>{if(!e||0===e.length)return"";let t=Object(i["dirname"])(e[0]);for(let s=1;s<e.length;s++)while(!e[s].includes(t)&&t.length>1)t=Object(i["dirname"])(t);return t},he=new Set;let ye;const be=[],ve=[];let _e=null,we="";const ke=new Map;let Se=Date.now(),je=1e3;const Te=e=>f["a"].torrentToJson(e,je,ke),He=(e,t)=>{const s=t&&t.trim(),o="string"===typeof e?Ee.get(e):e;o&&o.trackerMap&&(o.trackerMap.has(s)||(console.log("add tracker",e,s,o.trackerMap.get(s),o.trackerMap.size),o.trackerMap.set(s,{status:"connecting"}),f["a"].addTracker(o,s)))},Ee=new c.a({peerId:ue,maxConns:20});Ee.on("error",(e=>{console.warn(e)})),Ee.on("ready",(()=>{Object(h["b"])(Ee)}));let xe=!0;const Ae=(e=!1)=>{if(!xe&&!e)return setTimeout(Ae,1e3),console.log("skip send");const t=Date.now();je=(t-Se)/1e3,Se=t;let s=0,o=0;if(Ee.torrents.length){const e=Ee.torrents.filter((e=>!ve.includes(e.infoHash)&&!(e.isAutoUpload&&!e.ready&&!e.verifyStatus))),t=e.map((e=>{e.done||"number"!==typeof e.usedTime||(e.usedTime+=1e3);const t=Te(e);if(ke.has(t.infoHash)&&e.ready){const n=ke.get(t.infoHash);0===n.downloaded?t.downloadSpeed=0:t.downloadSpeed=Math.floor((e.downloaded-n.downloaded)/je),0===n.uploaded?t.uploadSpeed=0:t.uploadSpeed=Math.floor((e.uploaded-n.uploaded)/je),t.downloadSpeed<0&&(t.downloadSpeed=0),t.uploadSpeed<0&&(t.uploadSpeed=0),s+=t.downloadSpeed,o+=t.uploadSpeed,ke.set(t.infoHash,{downloaded:e.downloaded,uploaded:e.uploaded})}else t.downloadSpeed=0,t.uploadSpeed=0,ke.set(t.infoHash,{downloaded:0,uploaded:0});return t}));ce.emit("torrents",t)}else Ee.ready&&ce.emit("torrents",[]);ce.emit("client-info",{downloadSpeed:s<0?0:s,uploadSpeed:o<0?0:o,progress:Ee.progress,taskNum:Ee.torrents.length}),Ee.torrents.length>50&&(Ee.maxConns=Math.min(Ee.maxConns,10)),e||(Ee.torrents.length>100?(Ee.maxConns=Math.min(Ee.maxConns,5),setTimeout(Ae,2e3)):setTimeout(Ae,1e3))};setTimeout(Ae,1e3);let Ce=null;const Oe=()=>{Ce&&clearTimeout(Ce),Ce=setTimeout((()=>{Ae(!0)}),1e3)},Ne=e=>{if(e.upload)return;e.isSeeding=!0;const t=Te(e);ce.emit("done",t),ce.emit("finish-all-payments",t),e.completedTime||(e.completedTime=Date.now())},Ue=e=>{const t=Te(e);console.log("ready",t),ce.emit("ready",t),ye===t.infoHash&&(Fe(t.infoHash,t),ye=""),0===Ee.torrents.filter((e=>!e.ready)).length&&console.log("All torrents are ready")},qe=(e,t)=>{ce.emit("metadata",e.infoHash),ce.emit("data",Te(e))},De=(e,t)=>{if(e.use(Object(h["a"])(Ee,t)),"webrtc"===e.type){const s=()=>{var o,n,r,a,i;if(e.remoteAddress)return;const l=t._peers[e.peerId];if(!l)return setTimeout(s,1e3);const c=null===(o=l.conn)||void 0===o||null===(n=o._pc)||void 0===n||null===(r=n.currentRemoteDescription)||void 0===r||null===(a=r.sdp)||void 0===a||null===(i=a.match(/c=IN\sIP\d\s(.*)/))||void 0===i?void 0:i[1];if(!c)return setTimeout(s,1e3);e.remoteAddress=c};s()}},Le=(e,t,s,o)=>{console.log("infoHash",e),ve.includes(e)&&ve.splice(ve.indexOf(e),1),be.includes(e)&&Ee.get(e)!==t?(console.log("Destroy tr"),ce.emit("existed",e),t.destroy()):ce.emit("infohash",e,{...s,isSeeding:o}),be.push(e),Oe()},Re=(e,t={},s=!1)=>{t||(t={}),e.pending=!1,e.removeAllListeners(),e.setMaxListeners(0),console.log(`Add listeners to torrent ${e.infoHash||e.token||e.origin}`),e.on("done",(()=>Ne(e))),e.on("ready",(()=>Ue(e))),e.on("metadata",(()=>qe(e,t))),e.on("infoHash",(o=>{Le(o,e,t,s)})),e.on("warning",(()=>{})),e.on("error",(s=>{console.log("Torrent error",s,t),ce.emit("error",Te(e),s.message)})),e.on("wire",(t=>De(t,e))),e.on("discovery",(()=>{if(e.discovery){if(console.log("start discovery"),e.trackerMap=new me,e.discovery._announce.forEach((t=>{if(e.trackerMap.set(t,{status:"connecting"}),!t.startsWith("ws")){if(t.match(/(\d{1,3}\.){3}\d{1,3}/))return;e.trackerMap.set(t+"@6",{status:"connecting"})}})),e.discovery.tracker.on("warning",((t,s,o)=>{if(!s)return console.warn("No emitted url",t);6===o&&(s+="@6"),e.trackerMap.set(s,{status:"error",message:f["a"].parseTrackerWarning(t.message)})})),e.discovery.tracker.on("update",((t,s,o)=>{if(!s)return console.warn("No emitted url",t);6===o&&(s+="@6"),e.trackerMap.set(s,{status:"updated",info:t})})),t.customTrackers)for(const s of t.customTrackers)He(e,s)}else console.log("no discovery")}))},$e=(e,t,s)=>{if(t.isSeeding&&1===t.progress)return Me(e,t.file,t);if(t.infoHash){const e=t.infoHash.match(/btih:([^&]*)/),s=e&&e[1]||t.infoHash;if(s&&Ee.get(s))return console.log("exist",Ee.get(s)),ce.emit("existed",s)}if(t.origin){if(he.has(t.origin))return console.log("origin lock",t.origin),he.delete(t.origin);he.add(t.origin)}if(t.token!==t.origin){if(he.has(t.token))return console.log("token lock",t.token),console.log(he),he.delete(t.token);he.add(t.token)}const o=()=>{const o=t.torrentPath&&Object(a["existsSync"])(t.torrentPath)?t.torrentPath:Object(a["existsSync"])(t.token||t.origin)?t.token||t.origin:t.infoHash;console.log("[Add] TorrentID:",o);const n=Ee.add(o,{path:le,store:m.a,storeOpts:{postTitle:t.postTitle||""},storeCacheSlots:1,strategy:"sequential",maxWebConns:Ee.maxConns,announce:[].concat(...t.trackers||[],...ie.getUserSettings("trackerList"))});n.token=e,n.origin=t.infoHash||t.token||t.origin,n.createdTime=t.createdTime||Date.now(),n.usedTime=t.usedTime||0,t.fromPost&&(n.fromPost=t.fromPost),t.postTitle&&(n.postTitle=t.postTitle),t.name&&(n.name=t.name),t.subtitleList&&t.subtitleList.length&&(n.subtitleList=t.subtitleList),Re(n,t),n.once("infoHash",(()=>{he.delete(t.origin),he.delete(n.infoHash),he.delete(t.token),s&&s(n)})),t.verifiedPieces&&n.once("metadata",(()=>{if(n.length<2e8)return;let e=0,s=.2;n.length>5e9&&(s=.1),n.length>2e10&&(s=.05),n.length>5e10&&(s=.01),n.length>1e11&&(s=.005),t.verifiedPieces.forEach((t=>{if(Array.isArray(t)){const[o,r]=t;for(let t=o+1;t<r-1;t++)Math.random()>s&&n._markVerified(t),e++}})),console.log("mark verified",t.verifiedPieces,e)}))};if(Ee.get(t.infoHash))Ee.remove(t.infoHash,o);else if(Ee.torrents.some((t=>t.token===e))){const t=Ee.torrents.find((t=>t.token===e));if(!t)return o();if(t.infoHash)return s&&s(t);t.once("infoHash",(()=>s&&s(t)))}else o()},Ie=e=>{if(he.has(e))return;he.add(e),_e&&we===e&&(_e.destroy(),_e=null,we="");const t=Ee.get(e);if(t&&(t.isSeeding||t.done)&&(t.completed=!0),t)t.destroy((()=>{he.delete(e),ce.emit("stop",e,t.completed)}));else if(he.delete(e),e){const t=Ee.torrents.find((t=>t.token===e));t&&t.destroy((()=>{he.delete(e),ce.emit("stop",e,t.completed)}))}else ce.emit("notfound",e);be.includes(e)&&be.splice(be.indexOf(e),1),Oe()},Pe=(e,t,s)=>{if(he.has(e))return;he.add(e),ve.push(e),_e&&we===e&&(_e.destroy(),_e=null,we="");const o=Ee.get(e)||Ee.torrents.find((t=>t.token===e));if(console.log("delete",e,o,t),o){o.emit("deleted"),console.log("emit",o.emit);const n=o.files.length?o.files.map((e=>e.path)):o.file||[],r=fe(n);o.destroy({destroyStore:t},(()=>{"function"===typeof s&&s(),t?ce.emit("delete",o.infoHash||e,r,n):ce.emit("delete",o.infoHash||e),he.delete(e);try{Ee.remove(o.infoHash)}catch(a){}}))}else he.delete(e),ce.emit("notfound",e);while(be.includes(e))be.splice(be.indexOf(e),1);Oe()},Me=(e,t,s,o=!1,n=null)=>{if(s.infoHash&&Ee.get(s.infoHash))return console.log("skip existed",s.infoHash);const r=s.infoHash||s.token||s.origin||(Array.isArray(t)?t[0]:t);if(r){if(he.has(r))return;he.add(r)}let i=null;const l=[...s.trackers||[],...ie.getUserSettings("trackerList")],c={...s,store:m.a,storeOpts:{postTitle:s.postTitle||""},storeCacheSlots:1,strategy:"sequential",maxWebConns:Ee.maxConns,announce:l};return s.infoHash&&!s.upload&&s.files.length?(console.log("[seed] add torrent with token"),console.log(s),i=Ee.add(s.infoHash||s.token||s.origin,Object.assign(c,{path:le,skipVerify:1===s.progress}))):s.isSeeding&&s.torrentPath&&Object(a["existsSync"])(s.torrentPath)?(console.log("[seed] add torrent with torrentPath"),i=Ee.add(s.torrentPath,Object.assign(c,{path:le,skipVerify:!0}))):s.isSeeding&&s.magnetURI&&!s.isUploadByFiles?(console.log("[seed] add torrent with magnetURI"),i=Ee.add(s.magnetURI,Object.assign(c,{path:le,skipVerify:!0})),i.upload=!0,i.isSeeding=!0):(console.log("[seed] Seed torrent with files",!!s.infoHash,s),i=Ee.seed(t,Object.assign(c,{skipVerify:!!s.infoHash,onProgress(e,t){i.verifyStatus={current:e,total:t}}})),i.isUploadByFiles=!0),console.log("seedTorrent",s,i,t),s.name&&(i.name=s.name),i.isAutoUpload=o,i.token=e,i.isSeeding=!0,i.upload=!0,i.paused=!1,i.file=t,i.createdTime=s.createdTime||Date.now(),Re(i,s,!0),i.once("infoHash",(()=>{he.delete(r),n&&n()})),i.once("metadata",(()=>{ce.emit("seed",Te(i))})),i.once("deleted",(()=>{c.onProgress&&(c.onProgress._destroyed=!0)})),i},ze=e=>{if(_e){if(we===e.infoHash)return ce.emit("server-ready",e.infoHash,{token:e.token,port:_e.address().port});_e.close((()=>{})),_e.closeAllConnections(),_e=null,we=""}console.log("Create server",e),_e=N(e),_e.listen(0,(()=>{const t=_e.address().port,s={token:e.token,port:t};ce.emit("server-ready",e.infoHash,s);const o=()=>{const t=e.files.map((t=>{const s=[];for(let o=t._startPiece;o<t._endPiece;o++)s.push(null===e.pieces[o]?1:0);return{name:t.name,path:t.path,progress:s}}));ce.emit("server-progress",e.infoHash,t)};setTimeout(o,1e3);const n=setInterval(o,5e3);_e.once("close",(()=>clearInterval(n)))}))},Fe=(e,t)=>{console.log("start server",e,t),ye=e;const s=Ee.get(e);if(!s)return $e(t.token||t.infoHash,t,(()=>Fe(e,t)));s.ready?(console.log("tr ready. start server"),ze(s,t)):s.once("ready",(()=>ze(s,t)))},Ge=()=>{},Ve=({infoHash:e,peerId:t,subId:s,level:o})=>{const n=Ee.get(e);if(!n)return console.log("not found",e),ce.emit("set-throttle",{code:-1,message:"Torrent Not Found"}),null;let r=null,a=null;for(const i of n.wires)if(s?i.remoteSub===s:i.peerId===t){r=i;try{i._setThrottleGroup(o)}catch(Je){a={code:-1,message:Je.message}}break}return r?a?ce.emit("set-throttle",a):ce.emit("set-throttle",{code:0,message:"success"}):ce.emit("set-throttle",{code:-1,message:"Peer Not Found"}),r},We=(e,t)=>{const s="webtorrent-save-torrent",o=Ee.get(e);if(!o)return;if(!o.torrentFile||!o.name)return ce.emit(s,{code:-1,message:"Torrent Not Ready"});const n=Object(i["resolve"])(t,`${o.name}.torrent`);if(Object(a["existsSync"])(n))return ce.emit(s,{code:0,message:"success",infoHash:e,torrentPath:n});Object(a["existsSync"])(t)||Object(a["mkdirSync"])(t,{recursive:!0}),Object(a["writeFileSync"])(n,o.torrentFile),ce.emit(s,{code:0,message:"success",infoHash:e,torrentPath:n})};ce.on("add-torrent",((e,t)=>{console.log("[webtorrent] Add torrent",e),$e(e,t)})),ce.on("stop-torrent",(e=>{console.log("Got stop",e,Ee.get(e)),Ie(e)})),ce.on("stop-all-uploading",(e=>{console.log("[webtorrent] Stop all uploading"),e.forEach((e=>{const t=Ee.torrents.find((t=>!(!t.infoHash||t.infoHash!==e.infoHash)||!(!t.token||t.token!==e.token)));t&&t.destroy()}))})),ce.on("delete-all",((e,t,s)=>{xe=!1,console.log("Delete all",e,t,s);const o=Ee.torrents.filter((t=>{if("all"===e)return!0;const o=t.upload||1===t.progress||t.isSeeding;return"upload"===e?!(!s&&t.isAutoUpload)&&o:!o}));if(!o.length)return void(xe=!0);let n=0;o.forEach((e=>{n++,ve.push(e.infoHash),e.removeAllListeners();try{Pe(e.infoHash,t,(()=>{ve.includes(e.infoHash)&&ve.splice(ve.indexOf(e.infoHash),1),n--,0===n&&(xe=!0)}))}catch(Je){}})),setTimeout((()=>{xe=!0}),2e3)})),ce.on("seed-torrent",(e=>{console.log("[webtorrent] Seed torrent");let{file:t,token:s,...o}=e;return t||(t=e.files.map((e=>e.path))),console.log(e),t.length?(s||(s=Math.random().toString().substring(2)),Me(s,t,o)):ce.emit("seed-error")})),ce.on("seed-torrents",(e=>{console.log(`[webtorrent] Seed ${e.length} torrents`),e.forEach((e=>{let{file:t,token:s,...o}=e;t||(t=e.files.map((e=>e.path))),s||(s=Math.random().toString().substring(2)),Me(s,t,o)}))})),ce.on("autoupload-files",(async e=>{console.log("autoupload files",e),Promise.all(e.map((e=>{if(console.log("Auto upload",e),!Ee.torrents.some((t=>t.files.some((t=>t.path===e))||t.file&&t.file.some&&t.file.some((t=>t===e))||t.file===e)))return new Promise((t=>{Me("autoupload-"+Object(i["basename"])(e),[e],{path:Object(i["dirname"])(e)},!0,t)}));console.log(`${e} is already uploaded, skipped`)}))).then((()=>{console.log("autoupload complete"),ce.emit("autoupload-complete")})).catch((e=>{ce.emit("autoupload-complete",e.message||e)}));const t=[];Ee.torrents.forEach((s=>{s.isAutoUpload&&s.ready&&(s.files.some((t=>e.includes(t.path)))?console.log(`${s.infoHash} is kept alive`):(console.log(`${s.infoHash} has been deleted. Destroy`,s.files.map((e=>e.path))),t.push(s)))})),t.forEach((e=>{e.destroy((()=>{ce.emit("delete",e.infoHash)}))}))})),ce.on("start-server",(({infoHash:e,conf:t})=>(console.log("start server",e,t),Fe(e,t)))),ce.on("stop-server",(()=>Ge())),ce.on("delete-torrent",((e,t)=>Pe(e,t))),ce.on("pend-torrent",(e=>{const t=Ee.get(e.infoHash);be.includes(e.infoHash)&&be.splice(be.indexOf(e.infoHash),1),console.log("Pend",e.infoHash,t),t&&(t.removeAllListeners(),t.destroy(),t.pending=!0,ce.emit("pending",Te(t)))})),ce.on("set-throttle-group",(({infoHash:e,peerId:t,subId:s,level:o})=>{console.log(e,t,s,o),Ve({infoHash:e,peerId:t,subId:s,level:o})})),ce.on("save-torrent-file",((e,t)=>We(e,t))),ce.on("add-tracker",((e,{infoHash:t,url:s})=>{console.log("add-tracker",t,s),He(t,s)})),ce.on("remove-tracker",((e,{infoHash:t,url:s})=>{console.log("remove-tracker",t,s),removeTracker(t,s)})),ce.on("update-settings",(({uploadSpeed:e,downloadSpeed:t,maximumConnectionsNum:s,payedUserShareRate:o,secureOption:n})=>{console.log("Set client",{uploadSpeed:e,downloadSpeed:t,maximumConnectionsNum:s,payedUserShareRate:o,secureOption:n});const r=Number(o||.7)||.7,a=parseInt(ge(e));if(isNaN(r)||isNaN(a)||(-1===a?Ee.throttleUpload(-1):Ee.throttleUpload(a,r)),t){const e=ge(t);Ee.throttleDownload(e)}s&&(Ee.maxConns=s),"string"===typeof n&&Object(d["setSecure"])(n)}));const Be={on(e,t){ce.on(e,t)},once(e,t){ce.once(e,t)},off(e,t){ce.off(e,t)},send(e,...t){ce.emit(e,...t)}}}}]);