(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[15],{2377:function(e,t,a){"use strict";a("d7f6")},ca3d:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"scrollEl",staticClass:"local-favorite",class:{web:!e.isElectron}},[a("input",{ref:"fileSelector",staticStyle:{display:"none"},attrs:{type:"file",name:"input-file",accept:".json"},on:{change:e.onFileChange}}),a("div",{staticClass:"library-inner-container"},[a("VirtualScrollGrid",{staticClass:"library-grid",attrs:{virtualScrollSliceRow:30,itemWidth:560,itemHeight:473,gutter:8,itemsSize:e.filteredFavorites.length,itemsFn:function(t,a){return e.filteredFavorites.slice(t,a)}},on:{"virtual-scroll":function(t){var a=t.from;return e.scrollIndex=a||0}},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.item;return[a("PostCard",{key:o.id,attrs:{post:o,followable:!e.lib.followingChannels.some((function(e){return e.id===o.channel.id}))},on:{follow:e.onFollow,preview:e.preview,"to-channel":e.toChannelPage}})]}},{key:"after",fn:function(){return[a("div",{staticClass:"rounded-borders bg-page column justify-center items-center",class:e.filteredFavorites.length?"q-mb-sm q-pa-md":"",style:e.filteredFavorites.length?{}:{height:"calc(100vh - var(--header-height) - var(--appbar-height) - 8px)"}},[e.filteredFavorites.length?e._e():a("div",[a("q-icon",{attrs:{name:"error_outline",size:"1.2rem"}}),a("span",{staticClass:"q-ml-sm"},[e._v(e._s(e.$t("credit_no_data")))])],1)])]},proxy:!0}])}),e._e()],1),e._e(),a("BackToTop",{attrs:{show:e.scrollIndex>0||e.showBackToTop},on:{click:e.handleBackToTop}}),a("div",{staticClass:"fixed-bottom-right save-or-load",class:{higher:e.scrollIndex>0||e.showBackToTop}},[a("q-btn",{staticClass:"backup-btn q-ma-xs",class:{hide:e.hideBtn},attrs:{fab:"","no-wrap":"",size:"18px",color:"primary",icon:"source"},on:{click:e.saveOrLoad}},[a("div",{staticClass:"fab-inner-text"},[e._v(e._s(e.$t("backup")))])])],1),a("q-dialog",{model:{value:e.showPreview,callback:function(t){e.showPreview=t},expression:"showPreview"}},[a("q-card",{staticClass:"image-preview-card"},[a("q-card-section",{staticClass:"q-pa-none"},[a("img",{staticClass:"preview-image",attrs:{src:e.previewImage}})]),a("q-card-actions",{staticClass:"q-pa-none",staticStyle:{position:"absolute",bottom:"0",right:"0"},attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",padding:"none",size:"20px",icon:"close",color:"grey"}})],1)],1)],1),a("q-dialog",{model:{value:e.showDialog,callback:function(t){e.showDialog=t},expression:"showDialog"}},[a("q-card",[a("q-card-section",{staticClass:"row"},[a("div",{staticClass:"text-h6 col-12"},[e._v(e._s(e.$t("import_or_export_favorites")))]),a("div",{staticClass:"col-12"},[e._v("\n            Total: "+e._s(e.favorites.length)+"\n          ")]),a("div",{staticClass:"btns col-12 text-right q-mt-md"},[a("q-btn",{attrs:{color:"primary",flat:"",icon:"save",label:e.$t("export_local_favorites")},on:{click:e.exportData}}),a("FileSelector",{attrs:{accept:{name:"JSON",extensions:["json"]}},on:{select:e.onFileChange}},[a("q-btn",{staticClass:"q-ml-md",attrs:{color:"primary",flat:"",icon:"add",label:e.$t("import_favorites_file")}})],1)],1)])],1)],1)],1)},i=[],s=(a("e39c"),a("d4b5"),a("9167")),r=a("8dd2"),l=a("1d74"),n=a("36a1"),c=a("3aea"),h=a("d310"),d=a("ef3c"),f=a("d32f"),v=a("80ff"),p=a("9a50"),u={name:"LibraryFavorite",components:{PostCard:r["a"],BackToTop:l["a"],FileSelector:p["a"]},mixins:[d["a"],Object(f["a"])("favorite"),v["a"]],data(){return{isElectron:Object(h["isElectron"])(),hideBtn:!1,favorites:s["a"].list(),scrollIndex:0,showPreview:!1,previewImage:"",showDialog:!1,lib:n["a"]}},computed:{filteredFavorites(){const e=this.searchText.toLowerCase(),t=n["a"].search.option.value,a=e=>{var a;switch(t){case"channel":return null===(a=e.channel)||void 0===a?void 0:a.title;case"postID":return e.id;case"postDesc":return e.description;default:return e.title}},o=t=>{var o;return Object(c["a"])(null===(o=a(t))||void 0===o?void 0:o.toLowerCase()).includes(e)};return this.favorites.filter(o)}},methods:{onScroll(e){this.scrollIndex=e.index},preview(e){this.previewImage=e,this.showPreview=!0},remove(e){return s["a"].remove(e)},saveOrLoad(){this.showDialog=!0},exportData(){Object(c["h"])(JSON.stringify({favorites:this.favorites}),"favorites.json"),this.showDialog=!1},importData(){console.log(this.$refs.fileSelector),this.$refs.fileSelector.value="",this.$refs.fileSelector.click()},onFileChange(e){e&&Object(c["g"])(e).then((e=>{if(!e)return this.$q.notify("Cannot read data from this file");const t=JSON.parse(e);if(!t.favorites||!Array.isArray(t.favorites))return this.$q.notify(this.$t("not_a_favorite_file"));s["a"].set(t.favorites),this.showDialog=!1}))},onFollow(e){if(n["a"].followingChannels.some((t=>t.id===e||t.soul===e)))return console.log("unfollow"),n["a"].unfollowChannel(e).then(console.log);console.log("follow"),n["a"].followChannel(e).then(console.log)},toChannelPage(e){console.log("to",e);const t=["id","title"].map((t=>{const a=e[t];return encodeURIComponent(t)+"="+encodeURIComponent(a)})).join("&"),a=`/library/channel?${t}`;this.$root.$emit("navigate-to",a),this.$router.push(a)},setSearch(){this.lib.setSearchOption([{label:this.$t("post_title"),value:"postTitle"},{label:this.$t("description"),value:"postDesc"},{label:this.$t("channel_title"),value:"channel"}])}},activated(){this.setSearch(),this.$root.$emit("navigate-to"),this.$root.$emit("navigate-to","/library/favorite"),this.hideBtn=!0,setTimeout((()=>{this.hideBtn=!1}),300)},deactivated(){this.hideBtn=!0},watch:{searchText(e){e&&this.active&&this.handleBackToTop()}}},m=u,g=(a("2377"),a("2b5f")),w=a("f106"),b=a("8a98"),C=a("526f"),_=a("7027"),x=a("fc38"),y=a("d919"),S=a("bcaf"),$=a("1043"),q=a("b2aa"),k=a("e586"),T=a("d7c7"),F=a("59ba"),D=a("a431"),I=a("09a4"),B=a.n(I),O=Object(g["a"])(m,o,i,!1,null,"c0faef30",null);t["default"]=O.exports;B()(O,"components",{QIcon:w["a"],QTable:b["a"],QLinearProgress:C["a"],QSpinnerIos:_["a"],QSeparator:x["a"],QPagination:y["a"],QVirtualScroll:S["a"],QBtn:$["a"],QDialog:q["a"],QCard:k["a"],QCardSection:T["a"],QCardActions:F["a"]}),B()(O,"directives",{ClosePopup:D["a"]})},d7f6:function(e,t,a){}}]);